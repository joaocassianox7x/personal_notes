

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Molecular Dynamics with LAMMPS &mdash; Personal Notes</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Harmonic Oscillator" href="harmonic_oscillator.html" />
    <link rel="prev" title="Force Fields : Water" href="force_fields.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Personal Notes
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aboutme.html">About Me</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction of Material</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics and Computational Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="pppm_ewald.html">PPPM vs Ewald (Long-Range Coulomb)</a></li>
<li class="toctree-l1"><a class="reference internal" href="double_pendulum.html">Double Pendulum via Lagrangian Mechanics</a></li>
<li class="toctree-l1"><a class="reference internal" href="computational_derivatives.html">Computational Derivatives</a></li>
<li class="toctree-l1"><a class="reference internal" href="force_fields.html">Force Fields : Water</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Molecular Dynamics with LAMMPS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#statistical-mechanics-foundations">Statistical Mechanics Foundations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#integration-algorithms">Integration Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lennard-jones-potential">Lennard-Jones Potential</a></li>
<li class="toctree-l2"><a class="reference internal" href="#energy-minimization">Energy Minimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-lammps-workflow">Basic LAMMPS Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simulation-example-lennard-jones-fluid">Simulation Example: Lennard-Jones Fluid</a></li>
<li class="toctree-l2"><a class="reference internal" href="#calculating-thermodynamic-properties">Calculating Thermodynamic Properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visualization-and-animation">Visualization and Animation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#complete-simulation-script">Complete Simulation Script</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expected-results">Expected Results</a></li>
<li class="toctree-l2"><a class="reference internal" href="#advanced-topics">Advanced Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="harmonic_oscillator.html">Quantum Harmonic Oscillator</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Math</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../math/functions.html">Functions and Domains</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/limits.html">Limits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../math/residue_theorem.html">Residue Theorem</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">DS, ML, and AI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ds_ai/python.html">Python for Data Science</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ds_ai/linear_regression.html">Linear Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ds_ai/logistic_regression.html">Logistic Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ds_ai/bias_variance.html">Bias - Variance Decomposition</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ds_ai/backpropagation.html">Backpropagation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ds_ai/pca.html">Principal Component Analysis (PCA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ds_ai/pca.html#references-and-further-reading">References and Further Reading</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Personal Notes</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Molecular Dynamics with LAMMPS</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/physics/lammps.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="molecular-dynamics-with-lammps">
<h1>Molecular Dynamics with LAMMPS<a class="headerlink" href="#molecular-dynamics-with-lammps" title="Link to this heading"></a></h1>
<p><strong>Overview</strong></p>
<p>LAMMPS (Large-scale Atomic/Molecular Massively Parallel Simulator) is a classical molecular dynamics code designed for materials modeling, soft matter, and biomolecular systems. It excels at simulating:</p>
<ul class="simple">
<li><p>Atomic systems with various force fields (LJ, EAM, ReaxFF, etc.)</p></li>
<li><p>Thermodynamic ensembles (NVE, NVT, NPT)</p></li>
<li><p>Large-scale parallel simulations (billions of atoms)</p></li>
<li><p>Non-equilibrium phenomena (shock waves, fluid flow, shear)</p></li>
</ul>
<p>This section covers the mathematical foundations, basic usage, energy minimization, and practical simulation examples with thermodynamic analysis.</p>
<section id="statistical-mechanics-foundations">
<h2>Statistical Mechanics Foundations<a class="headerlink" href="#statistical-mechanics-foundations" title="Link to this heading"></a></h2>
<p><strong>Microcanonical Ensemble (NVE)</strong></p>
<p>In the NVE ensemble, the number of particles <span class="math notranslate nohighlight">\(N\)</span>, volume <span class="math notranslate nohighlight">\(V\)</span>, and total energy <span class="math notranslate nohighlight">\(E\)</span> are conserved. The Hamiltonian governs the time evolution:</p>
<div class="math notranslate nohighlight">
\[\mathcal{H}(\mathbf{r}^N, \mathbf{p}^N) = \sum_{i=1}^N \frac{\mathbf{p}_i^2}{2m_i} + U(\mathbf{r}^N)\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{p}_i\)</span> are momenta, <span class="math notranslate nohighlight">\(m_i\)</span> are masses, and <span class="math notranslate nohighlight">\(U(\mathbf{r}^N)\)</span> is the potential energy.</p>
<p>Hamilton’s equations of motion:</p>
<div class="math notranslate nohighlight">
\[\dot{\mathbf{r}}_i = \frac{\partial \mathcal{H}}{\partial \mathbf{p}_i} = \frac{\mathbf{p}_i}{m_i}, \qquad
\dot{\mathbf{p}}_i = -\frac{\partial \mathcal{H}}{\partial \mathbf{r}_i} = -\nabla_i U\]</div>
<p>In Cartesian coordinates, this reduces to Newton’s equations:</p>
<div class="math notranslate nohighlight">
\[m_i \ddot{\mathbf{r}}_i = \mathbf{F}_i = -\nabla_i U(\mathbf{r}^N)\]</div>
<p><strong>Canonical Ensemble (NVT)</strong></p>
<p>In the NVT ensemble, temperature <span class="math notranslate nohighlight">\(T\)</span> is controlled via a thermostat. The Nosé-Hoover thermostat introduces an additional degree of freedom <span class="math notranslate nohighlight">\(\xi\)</span> with equations:</p>
<div class="math notranslate nohighlight">
\[m_i \ddot{\mathbf{r}}_i = \mathbf{F}_i - \xi \dot{\mathbf{r}}_i, \qquad
Q \dot{\xi} = \sum_{i=1}^N m_i \dot{\mathbf{r}}_i^2 - 3Nk_BT\]</div>
<p>where <span class="math notranslate nohighlight">\(Q\)</span> is the thermal inertia parameter (mass of the thermostat), and <span class="math notranslate nohighlight">\(k_B\)</span> is Boltzmann’s constant.</p>
<p>The instantaneous temperature is:</p>
<div class="math notranslate nohighlight">
\[T_{\text{inst}} = \frac{1}{3Nk_B} \sum_{i=1}^N m_i \dot{\mathbf{r}}_i^2\]</div>
<p><strong>Isothermal-Isobaric Ensemble (NPT)</strong></p>
<p>The NPT ensemble controls both temperature and pressure <span class="math notranslate nohighlight">\(P\)</span>. The Nosé-Hoover-Andersen barostat extends the thermostat with volume fluctuations:</p>
<div class="math notranslate nohighlight">
\[m_i \ddot{\mathbf{r}}_i = \mathbf{F}_i - (\xi + \eta) \dot{\mathbf{r}}_i\]</div>
<p>where <span class="math notranslate nohighlight">\(\eta\)</span> is the barostat variable coupled to the instantaneous pressure:</p>
<div class="math notranslate nohighlight">
\[W \dot{\eta} = 3V(P_{\text{inst}} - P_0)\]</div>
<p>with <span class="math notranslate nohighlight">\(W\)</span> being the barostat mass and <span class="math notranslate nohighlight">\(P_0\)</span> the target pressure. The instantaneous pressure (virial theorem):</p>
<div class="math notranslate nohighlight">
\[P_{\text{inst}} = \frac{Nk_BT}{V} + \frac{1}{3V} \sum_{i&lt;j} \mathbf{r}_{ij} \cdot \mathbf{F}_{ij}\]</div>
</section>
<section id="integration-algorithms">
<h2>Integration Algorithms<a class="headerlink" href="#integration-algorithms" title="Link to this heading"></a></h2>
<p><strong>Velocity Verlet (NVE)</strong></p>
<p>The velocity Verlet algorithm is symplectic and time-reversible, conserving energy in NVE:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{r}_i(t + \Delta t) &amp;= \mathbf{r}_i(t) + \mathbf{v}_i(t) \Delta t + \frac{1}{2} \mathbf{a}_i(t) (\Delta t)^2 \\
\mathbf{v}_i(t + \Delta t) &amp;= \mathbf{v}_i(t) + \frac{1}{2} [\mathbf{a}_i(t) + \mathbf{a}_i(t + \Delta t)] \Delta t\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{a}_i = \mathbf{F}_i / m_i\)</span>. The local truncation error is <span class="math notranslate nohighlight">\(O(\Delta t^4)\)</span>, global error <span class="math notranslate nohighlight">\(O(\Delta t^2)\)</span>.</p>
<p><strong>Stability and Timestep</strong></p>
<p>For harmonic oscillations with frequency <span class="math notranslate nohighlight">\(\omega_{\max}\)</span>, stability requires:</p>
<div class="math notranslate nohighlight">
\[\Delta t \ll \frac{2}{\omega_{\max}} = \frac{2\pi}{T_{\min}}\]</div>
<p>Typical values: <span class="math notranslate nohighlight">\(\Delta t = 0.5-2.0 \, \text{fs}\)</span> for atomistic simulations with covalent bonds.</p>
</section>
<section id="lennard-jones-potential">
<h2>Lennard-Jones Potential<a class="headerlink" href="#lennard-jones-potential" title="Link to this heading"></a></h2>
<p>The Lennard-Jones (12-6) potential models van der Waals interactions:</p>
<div class="math notranslate nohighlight">
\[U_{\text{LJ}}(r) = 4\varepsilon \left[ \left(\frac{\sigma}{r}\right)^{12} - \left(\frac{\sigma}{r}\right)^{6} \right]\]</div>
<p>Parameters:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\varepsilon\)</span>: depth of the potential well (energy scale)</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma\)</span>: distance where <span class="math notranslate nohighlight">\(U_{\text{LJ}} = 0\)</span> (length scale)</p></li>
<li><p><span class="math notranslate nohighlight">\(r_{\min} = 2^{1/6}\sigma \approx 1.122\sigma\)</span>: equilibrium distance (minimum energy)</p></li>
<li><p><span class="math notranslate nohighlight">\(U_{\min} = -\varepsilon\)</span> at <span class="math notranslate nohighlight">\(r = r_{\min}\)</span></p></li>
</ul>
<p><strong>Reduced Units</strong></p>
<p>LAMMPS uses reduced (dimensionless) units for LJ systems:</p>
<div class="math notranslate nohighlight">
\[r^* = \frac{r}{\sigma}, \quad
T^* = \frac{k_BT}{\varepsilon}, \quad
P^* = \frac{P\sigma^3}{\varepsilon}, \quad
t^* = t\sqrt{\frac{\varepsilon}{m\sigma^2}}\]</div>
<p>For argon: <span class="math notranslate nohighlight">\(\varepsilon/k_B \approx 120 \, \text{K}\)</span>, <span class="math notranslate nohighlight">\(\sigma \approx 3.4 \, \text{Å}\)</span>, <span class="math notranslate nohighlight">\(m = 39.948 \, \text{amu}\)</span>.</p>
<p><strong>Force and Virial</strong></p>
<p>The force is:</p>
<div class="math notranslate nohighlight">
\[\mathbf{F}_{ij} = -\nabla_i U_{\text{LJ}}(r_{ij}) = \frac{24\varepsilon}{r_{ij}} \left[ 2\left(\frac{\sigma}{r_{ij}}\right)^{12} - \left(\frac{\sigma}{r_{ij}}\right)^{6} \right] \hat{\mathbf{r}}_{ij}\]</div>
<p>The virial contribution (for pressure calculation):</p>
<div class="math notranslate nohighlight">
\[W = -\frac{1}{3} \sum_{i&lt;j} \mathbf{r}_{ij} \cdot \mathbf{F}_{ij}\]</div>
</section>
<section id="energy-minimization">
<h2>Energy Minimization<a class="headerlink" href="#energy-minimization" title="Link to this heading"></a></h2>
<p>Before MD, systems often require energy minimization to remove bad contacts and high-energy configurations.</p>
<p><strong>Steepest Descent</strong></p>
<p>The simplest gradient-based method:</p>
<div class="math notranslate nohighlight">
\[\mathbf{r}_i^{(n+1)} = \mathbf{r}_i^{(n)} - \alpha \nabla_i U(\mathbf{r}^{(n)})\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is the step size. Convergence is slow but robust for rough landscapes.</p>
<p><strong>Conjugate Gradient (CG)</strong></p>
<p>CG uses conjugate search directions <span class="math notranslate nohighlight">\(\mathbf{d}^{(n)}\)</span>:</p>
<div class="math notranslate nohighlight">
\[\mathbf{d}^{(0)} = -\nabla U(\mathbf{r}^{(0)}), \qquad
\mathbf{d}^{(n+1)} = -\nabla U(\mathbf{r}^{(n+1)}) + \beta^{(n)} \mathbf{d}^{(n)}\]</div>
<p>with Polak-Ribière update:</p>
<div class="math notranslate nohighlight">
\[\beta^{(n)} = \frac{\nabla U(\mathbf{r}^{(n+1)}) \cdot [\nabla U(\mathbf{r}^{(n+1)}) - \nabla U(\mathbf{r}^{(n)})]}{|\nabla U(\mathbf{r}^{(n)})|^2}\]</div>
<p>CG converges faster than steepest descent, especially near minima.</p>
<p><strong>LAMMPS Minimization Commands</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>minimize etol ftol maxiter maxeval
</pre></div>
</div>
<p>where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">etol</span></code> = energy tolerance (<span class="math notranslate nohighlight">\(\Delta E / N\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ftol</span></code> = force tolerance (max <span class="math notranslate nohighlight">\(|\mathbf{F}_i|\)</span>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxiter</span></code> = max iterations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">maxeval</span></code> = max force/energy evaluations</p></li>
</ul>
<p>Example:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>minimize 1.0e-4 1.0e-6 1000 10000
</pre></div>
</div>
</section>
<section id="basic-lammps-workflow">
<h2>Basic LAMMPS Workflow<a class="headerlink" href="#basic-lammps-workflow" title="Link to this heading"></a></h2>
<p><strong>1. Initialization</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># Units and atom style
units lj                  # reduced units
atom_style atomic         # point particles
dimension 3
boundary p p p            # periodic boundaries

# Simulation box
lattice fcc 0.8442        # density ρ* = 0.8442
region box block 0 10 0 10 0 10
create_box 1 box
create_atoms 1 box

# Mass (reduced units: m* = 1)
mass 1 1.0
</pre></div>
</div>
<p><strong>2. Interaction Potential</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># LJ potential with cutoff rc = 2.5σ
pair_style lj/cut 2.5
pair_coeff 1 1 1.0 1.0   # ε = 1, σ = 1
</pre></div>
</div>
<p><strong>3. Thermodynamic Output</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>thermo_style custom step temp pe ke etotal press vol density
thermo 100              # output every 100 steps
</pre></div>
</div>
<p><strong>4. Initial Velocities</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>velocity all create 1.0 87287 dist gaussian  # T* = 1.0, random seed
</pre></div>
</div>
<p><strong>5. Time Integration</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># NVE ensemble
fix 1 all nve
timestep 0.005          # Δt* = 0.005

# NVT ensemble (Nosé-Hoover thermostat)
fix 1 all nvt temp 1.0 1.0 0.1   # T* = 1.0, damping τ* = 0.1

# NPT ensemble
fix 1 all npt temp 1.0 1.0 0.1 iso 1.0 1.0 1.0  # T* = 1.0, P* = 1.0
</pre></div>
</div>
<p><strong>6. Run Simulation</strong></p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>run 10000               # 10,000 timesteps
</pre></div>
</div>
</section>
<section id="simulation-example-lennard-jones-fluid">
<h2>Simulation Example: Lennard-Jones Fluid<a class="headerlink" href="#simulation-example-lennard-jones-fluid" title="Link to this heading"></a></h2>
<p>We simulate a Lennard-Jones fluid in the NPT ensemble, starting from an FCC lattice at high density, equilibrating to liquid density, and calculating thermodynamic properties.</p>
<p><strong>LAMMPS Input Script</strong> (<code class="docutils literal notranslate"><span class="pre">lj_fluid.in</span></code>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span># LJ fluid simulation - NPT ensemble
units lj
atom_style atomic
dimension 3
boundary p p p

# Create FCC lattice (864 atoms)
lattice fcc 0.8442
region box block 0 6 0 6 0 6
create_box 1 box
create_atoms 1 box
mass 1 1.0

# LJ potential
pair_style lj/cut 2.5
pair_coeff 1 1 1.0 1.0

# Neighbor list
neighbor 0.3 bin
neigh_modify every 1 delay 0 check yes

# Initial velocities (T* = 2.0, high temperature)
velocity all create 2.0 482901 dist gaussian

# Thermodynamic output
thermo_style custom step temp pe ke etotal press vol density
thermo 100

# Trajectory output for visualization
dump 1 all custom 50 trajectory.lammpstrj id type x y z
dump_modify 1 sort id

# NPT equilibration (cool from T* = 2.0 to T* = 1.0)
fix 1 all npt temp 2.0 1.0 0.1 iso 1.0 1.0 1.0
timestep 0.005
run 5000

# NPT production run (T* = 1.0, P* = 1.0)
unfix 1
fix 2 all npt temp 1.0 1.0 0.1 iso 1.0 1.0 1.0
run 10000

write_data lj_final.data
</pre></div>
</div>
<p><strong>Running the Simulation</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>lmp<span class="w"> </span>-in<span class="w"> </span>lj_fluid.in<span class="w"> </span>&gt;<span class="w"> </span>lj_fluid.log
</pre></div>
</div>
</section>
<section id="calculating-thermodynamic-properties">
<h2>Calculating Thermodynamic Properties<a class="headerlink" href="#calculating-thermodynamic-properties" title="Link to this heading"></a></h2>
<p><strong>Average Temperature</strong></p>
<p>From the kinetic energy:</p>
<div class="math notranslate nohighlight">
\[\langle T^* \rangle = \frac{2}{3N} \left\langle \sum_{i=1}^N \frac{1}{2} m_i v_i^2 \right\rangle\]</div>
<p><strong>Average Pressure</strong></p>
<p>Virial equation:</p>
<div class="math notranslate nohighlight">
\[\langle P^* \rangle = \rho^* T^* + \frac{1}{3V^*} \left\langle \sum_{i&lt;j} r_{ij}^* \frac{dU_{\text{LJ}}^*}{dr_{ij}^*} \right\rangle\]</div>
<p><strong>Heat Capacity (Constant Volume)</strong></p>
<p>From energy fluctuations:</p>
<div class="math notranslate nohighlight">
\[C_V = \frac{\partial \langle E \rangle}{\partial T} = \frac{\langle E^2 \rangle - \langle E \rangle^2}{k_B T^2}\]</div>
<p>In reduced units:</p>
<div class="math notranslate nohighlight">
\[C_V^* = \frac{\langle (E^*)^2 \rangle - \langle E^* \rangle^2}{(T^*)^2}\]</div>
<p><strong>Radial Distribution Function</strong> <span class="math notranslate nohighlight">\(g(r)\)</span></p>
<p>The probability of finding a particle at distance <span class="math notranslate nohighlight">\(r\)</span> from a reference particle:</p>
<div class="math notranslate nohighlight">
\[g(r) = \frac{V}{N^2} \left\langle \sum_{i=1}^N \sum_{j \neq i} \delta(r - r_{ij}) \right\rangle \cdot \frac{1}{4\pi r^2}\]</div>
<p>In LAMMPS:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>compute rdf all rdf 100 1 1 cutoff 5.0
fix 3 all ave/time 100 1 100 c_rdf[*] file rdf.dat mode vector
</pre></div>
</div>
<p><strong>Diffusion Coefficient</strong></p>
<p>From the mean-square displacement (Einstein relation):</p>
<div class="math notranslate nohighlight">
\[D = \lim_{t \to \infty} \frac{1}{6t} \left\langle |\mathbf{r}_i(t) - \mathbf{r}_i(0)|^2 \right\rangle\]</div>
<p>In LAMMPS:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>compute msd all msd
fix 4 all ave/time 1 1 1 c_msd[4] file msd.dat
</pre></div>
</div>
</section>
<section id="visualization-and-animation">
<h2>Visualization and Animation<a class="headerlink" href="#visualization-and-animation" title="Link to this heading"></a></h2>
<p>To create trajectory visualizations, we post-process the <code class="docutils literal notranslate"><span class="pre">trajectory.lammpstrj</span></code> file using Python.</p>
<p><strong>Python Script</strong> (<code class="docutils literal notranslate"><span class="pre">visualize_lammps.py</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">PillowWriter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_lammpstrj</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse LAMMPS trajectory file.&quot;&quot;&quot;</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;ITEM: TIMESTEP&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">timestep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

            <span class="c1"># Number of atoms</span>
            <span class="k">assert</span> <span class="s1">&#39;ITEM: NUMBER OF ATOMS&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">natoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

            <span class="c1"># Box bounds</span>
            <span class="k">assert</span> <span class="s1">&#39;ITEM: BOX BOUNDS&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">xlo_xhi</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="n">ylo_yhi</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="n">zlo_zhi</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="n">xlo_xhi</span><span class="p">,</span> <span class="n">ylo_yhi</span><span class="p">,</span> <span class="n">zlo_zhi</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span>

            <span class="c1"># Atom data</span>
            <span class="k">assert</span> <span class="s1">&#39;ITEM: ATOMS&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="n">natoms</span>

            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;timestep&#39;</span><span class="p">:</span> <span class="n">timestep</span><span class="p">,</span> <span class="s1">&#39;coords&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coords</span><span class="p">),</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="n">box</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">frames</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_animation</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;lammps_trajectory.gif&#39;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create animated GIF from trajectory frames.&quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

    <span class="c1"># Set up the writer</span>
    <span class="n">writer</span> <span class="o">=</span> <span class="n">PillowWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">writer</span><span class="o">.</span><span class="n">saving</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">[::</span><span class="n">skip</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>  <span class="c1"># Limit to first 50 frames</span>
                <span class="k">break</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;coords&#39;</span><span class="p">]</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;box&#39;</span><span class="p">]</span>

            <span class="c1"># Plot atoms</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                      <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>

            <span class="c1"># Set axis limits from box</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x*&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y*&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z*&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Timestep: </span><span class="si">{</span><span class="n">frame</span><span class="p">[</span><span class="s2">&quot;timestep&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="n">writer</span><span class="o">.</span><span class="n">grab_frame</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Animation saved to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_thermodynamics</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;lj_fluid.log&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot thermodynamic quantities from LAMMPS log.&quot;&quot;&quot;</span>
    <span class="c1"># Parse log file (simple parsing - assumes thermo_style custom)</span>
    <span class="n">step</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">pe</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">etotal</span><span class="p">,</span> <span class="n">press</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">logfile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reading</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Step Temp PotEng KinEng TotEng Press Volume Density&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">reading</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">reading</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Loop time&#39;</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                        <span class="n">step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">pe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">ke</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                        <span class="n">etotal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="n">press</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                        <span class="n">vol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
                        <span class="n">density</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="c1"># Create plots</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature T*&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">press</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure P*&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">etotal</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total Energy E*&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density ρ*&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;lammps_thermodynamics.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thermodynamics plot saved to lammps_thermodynamics.png&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="c1"># Read and visualize trajectory</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="n">read_lammpstrj</span><span class="p">(</span><span class="s1">&#39;trajectory.lammpstrj&#39;</span><span class="p">)</span>
    <span class="n">create_animation</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="s1">&#39;lammps_trajectory.gif&#39;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Plot thermodynamic properties</span>
    <span class="n">plot_thermodynamics</span><span class="p">(</span><span class="s1">&#39;lj_fluid.log&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Running the Visualization</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>visualize_lammps.py
</pre></div>
</div>
<p>This generates:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lammps_trajectory.gif</span></code>: animated 3D visualization of particle motion</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lammps_thermodynamics.png</span></code>: time evolution of T*, P*, E*, and ρ*</p></li>
</ul>
</section>
<section id="complete-simulation-script">
<h2>Complete Simulation Script<a class="headerlink" href="#complete-simulation-script" title="Link to this heading"></a></h2>
<p>The full Python script that creates the LAMMPS input, runs the simulation, and generates visualizations is provided below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">LAMMPS Lennard-Jones fluid simulation with visualization</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.animation</span><span class="w"> </span><span class="kn">import</span> <span class="n">PillowWriter</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">mpl_toolkits.mplot3d</span><span class="w"> </span><span class="kn">import</span> <span class="n">Axes3D</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_lammps_input</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate LAMMPS input script.&quot;&quot;&quot;</span>
    <span class="n">script</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;# LJ fluid simulation - NPT ensemble</span>
<span class="s2">units lj</span>
<span class="s2">atom_style atomic</span>
<span class="s2">dimension 3</span>
<span class="s2">boundary p p p</span>

<span class="s2"># Create FCC lattice (864 atoms)</span>
<span class="s2">lattice fcc 0.8442</span>
<span class="s2">region box block 0 6 0 6 0 6</span>
<span class="s2">create_box 1 box</span>
<span class="s2">create_atoms 1 box</span>
<span class="s2">mass 1 1.0</span>

<span class="s2"># LJ potential</span>
<span class="s2">pair_style lj/cut 2.5</span>
<span class="s2">pair_coeff 1 1 1.0 1.0</span>

<span class="s2"># Neighbor list</span>
<span class="s2">neighbor 0.3 bin</span>
<span class="s2">neigh_modify every 1 delay 0 check yes</span>

<span class="s2"># Initial velocities (T* = 2.0)</span>
<span class="s2">velocity all create 2.0 482901 dist gaussian</span>

<span class="s2"># Thermodynamic output</span>
<span class="s2">thermo_style custom step temp pe ke etotal press vol density</span>
<span class="s2">thermo 100</span>

<span class="s2"># Trajectory output</span>
<span class="s2">dump 1 all custom 50 trajectory.lammpstrj id type x y z</span>
<span class="s2">dump_modify 1 sort id</span>

<span class="s2"># RDF calculation</span>
<span class="s2">compute rdf all rdf 100 1 1 cutoff 5.0</span>
<span class="s2">fix 3 all ave/time 100 10 1000 c_rdf[*] file rdf.dat mode vector</span>

<span class="s2"># MSD calculation</span>
<span class="s2">compute msd all msd</span>
<span class="s2">fix 4 all ave/time 1 1 1 c_msd[4] file msd.dat</span>

<span class="s2"># NPT equilibration (cool from T* = 2.0 to T* = 1.0)</span>
<span class="s2">fix 1 all npt temp 2.0 1.0 0.1 iso 1.0 1.0 1.0</span>
<span class="s2">timestep 0.005</span>
<span class="s2">run 5000</span>

<span class="s2"># NPT production (T* = 1.0, P* = 1.0)</span>
<span class="s2">unfix 1</span>
<span class="s2">fix 2 all npt temp 1.0 1.0 0.1 iso 1.0 1.0 1.0</span>
<span class="s2">run 10000</span>

<span class="s2">write_data lj_final.data</span>
<span class="s2">&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;lj_fluid.in&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">script</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Created lj_fluid.in&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_lammps</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run LAMMPS simulation.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;lj_fluid.in&#39;</span><span class="p">):</span>
        <span class="n">create_lammps_input</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Running LAMMPS simulation...&#39;</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s1">&#39;lmp&#39;</span><span class="p">,</span> <span class="s1">&#39;-in&#39;</span><span class="p">,</span> <span class="s1">&#39;lj_fluid.in&#39;</span><span class="p">],</span>
                           <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;lj_fluid.log&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">returncode</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Simulation completed successfully&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Error running LAMMPS: </span><span class="si">{</span><span class="n">result</span><span class="o">.</span><span class="n">stderr</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_lammpstrj</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse LAMMPS trajectory file.&quot;&quot;&quot;</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">frames</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;ITEM: TIMESTEP&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">timestep</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

            <span class="k">assert</span> <span class="s1">&#39;ITEM: NUMBER OF ATOMS&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">natoms</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">2</span>

            <span class="k">assert</span> <span class="s1">&#39;ITEM: BOX BOUNDS&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">xlo_xhi</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="n">ylo_yhi</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="n">zlo_zhi</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
            <span class="n">box</span> <span class="o">=</span> <span class="p">[</span><span class="n">xlo_xhi</span><span class="p">,</span> <span class="n">ylo_yhi</span><span class="p">,</span> <span class="n">zlo_zhi</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">4</span>

            <span class="k">assert</span> <span class="s1">&#39;ITEM: ATOMS&#39;</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])])</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="n">natoms</span>

            <span class="n">frames</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;timestep&#39;</span><span class="p">:</span> <span class="n">timestep</span><span class="p">,</span> <span class="s1">&#39;coords&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coords</span><span class="p">),</span> <span class="s1">&#39;box&#39;</span><span class="p">:</span> <span class="n">box</span><span class="p">})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">frames</span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_animation</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;lammps_trajectory.gif&#39;</span><span class="p">,</span> <span class="n">skip</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create animated GIF.&quot;&quot;&quot;</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>

    <span class="n">writer</span> <span class="o">=</span> <span class="n">PillowWriter</span><span class="p">(</span><span class="n">fps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">writer</span><span class="o">.</span><span class="n">saving</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">output_file</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames</span><span class="p">[::</span><span class="n">skip</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;</span> <span class="mi">50</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;coords&#39;</span><span class="p">]</span>
            <span class="n">box</span> <span class="o">=</span> <span class="n">frame</span><span class="p">[</span><span class="s1">&#39;box&#39;</span><span class="p">]</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">coords</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">coords</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
                      <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">([</span><span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">([</span><span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">box</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x* (σ)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y* (σ)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;z* (σ)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;LJ Fluid: Timestep </span><span class="si">{</span><span class="n">frame</span><span class="p">[</span><span class="s2">&quot;timestep&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

            <span class="n">writer</span><span class="o">.</span><span class="n">grab_frame</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Animation saved to </span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_thermodynamics</span><span class="p">(</span><span class="n">logfile</span><span class="o">=</span><span class="s1">&#39;lj_fluid.log&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot thermodynamic quantities.&quot;&quot;&quot;</span>
    <span class="n">step</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">pe</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">etotal</span><span class="p">,</span> <span class="n">press</span><span class="p">,</span> <span class="n">vol</span><span class="p">,</span> <span class="n">density</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">logfile</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reading</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;Step Temp PotEng KinEng TotEng Press Volume Density&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                <span class="n">reading</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">reading</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;Loop time&#39;</span><span class="p">):</span>
                    <span class="k">break</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">==</span> <span class="mi">8</span><span class="p">:</span>
                        <span class="n">step</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="n">pe</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                        <span class="n">ke</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
                        <span class="n">etotal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
                        <span class="n">press</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
                        <span class="n">vol</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
                        <span class="n">density</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature T*&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target T*=1.0&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Temperature Evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">press</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure P*&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Target P*=1.0&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pressure Evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">etotal</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total Energy E*&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Energy Conservation&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">step</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Step&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density ρ*&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Density Evolution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;lammps_thermodynamics.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Thermodynamics plot saved to lammps_thermodynamics.png&#39;</span><span class="p">)</span>

    <span class="c1"># Calculate averages (last 5000 steps - equilibrated)</span>
    <span class="n">eq_idx</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">step</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">avg_temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="n">eq_idx</span><span class="p">:])</span>
    <span class="n">avg_press</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">press</span><span class="p">[</span><span class="n">eq_idx</span><span class="p">:])</span>
    <span class="n">avg_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">density</span><span class="p">[</span><span class="n">eq_idx</span><span class="p">:])</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nEquilibrated averages (last half):&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  &lt;T*&gt; = </span><span class="si">{</span><span class="n">avg_temp</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  &lt;P*&gt; = </span><span class="si">{</span><span class="n">avg_press</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;  &lt;ρ*&gt; = </span><span class="si">{</span><span class="n">avg_density</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">plot_rdf</span><span class="p">(</span><span class="n">rdffile</span><span class="o">=</span><span class="s1">&#39;rdf.dat&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Plot radial distribution function.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">rdffile</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">rdffile</span><span class="si">}</span><span class="s1"> not found&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">rdffile</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">g_r</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">g_r</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;r* (σ)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;g(r*)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Radial Distribution Function - LJ Fluid&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;lammps_rdf.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RDF plot saved to lammps_rdf.png&#39;</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Main execution function.&quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;LAMMPS Lennard-Jones Fluid Simulation&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>

    <span class="c1"># Create input and run</span>
    <span class="n">create_lammps_input</span><span class="p">()</span>
    <span class="n">run_lammps</span><span class="p">()</span>

    <span class="c1"># Visualizations</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nGenerating visualizations...&#39;</span><span class="p">)</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="n">read_lammpstrj</span><span class="p">(</span><span class="s1">&#39;trajectory.lammpstrj&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">frames</span><span class="p">:</span>
        <span class="n">create_animation</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">&#39;lj_fluid.log&#39;</span><span class="p">):</span>
        <span class="n">plot_thermodynamics</span><span class="p">(</span><span class="s1">&#39;lj_fluid.log&#39;</span><span class="p">)</span>

    <span class="n">plot_rdf</span><span class="p">(</span><span class="s1">&#39;rdf.dat&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">nAll done!&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="expected-results">
<h2>Expected Results<a class="headerlink" href="#expected-results" title="Link to this heading"></a></h2>
<p>After running the simulation and visualization script, you should obtain:</p>
<ol class="arabic">
<li><p><strong>Trajectory Animation</strong> (<code class="docutils literal notranslate"><span class="pre">lammps_trajectory.gif</span></code>): 3D visualization showing liquid-like motion of particles</p></li>
<li><p><strong>Thermodynamic Properties</strong> (<code class="docutils literal notranslate"><span class="pre">lammps_thermodynamics.png</span></code>):</p>
<ul class="simple">
<li><p>Temperature equilibrates to <span class="math notranslate nohighlight">\(T^* = 1.0\)</span></p></li>
<li><p>Pressure fluctuates around <span class="math notranslate nohighlight">\(P^* = 1.0\)</span></p></li>
<li><p>Density stabilizes around <span class="math notranslate nohighlight">\(\rho^* \approx 0.84\)</span></p></li>
</ul>
</li>
<li><p><strong>Radial Distribution Function</strong> (<code class="docutils literal notranslate"><span class="pre">lammps_rdf.png</span></code>):</p>
<p>First peak at <span class="math notranslate nohighlight">\(r^* \approx 1.1\)</span> (nearest neighbors), characteristic liquid structure</p>
</li>
</ol>
<a class="reference internal image-reference" href="../_images/lammps_trajectory.gif"><img alt="LAMMPS trajectory animation of LJ fluid" class="align-center" src="../_images/lammps_trajectory.gif" style="width: 80%;" />
</a>
<a class="reference internal image-reference" href="../_images/lammps_thermodynamics.png"><img alt="Thermodynamic properties evolution" class="align-center" src="../_images/lammps_thermodynamics.png" style="width: 100%;" />
</a>
<a class="reference internal image-reference" href="../_images/lammps_rdf.png"><img alt="Radial distribution function" class="align-center" src="../_images/lammps_rdf.png" style="width: 80%;" />
</a>
</section>
<section id="advanced-topics">
<h2>Advanced Topics<a class="headerlink" href="#advanced-topics" title="Link to this heading"></a></h2>
<p><strong>Parallel Execution</strong></p>
<p>LAMMPS uses MPI for parallel computing:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mpirun<span class="w"> </span>-np<span class="w"> </span><span class="m">4</span><span class="w"> </span>lmp<span class="w"> </span>-in<span class="w"> </span>lj_fluid.in<span class="w">    </span><span class="c1"># 4 processors</span>
</pre></div>
</div>
<p><strong>Custom Potentials</strong></p>
<p>For water simulations (TIP3P, SPC/E):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>pair_style lj/cut/coul/long 10.0
kspace_style pppm 1.0e-4
pair_coeff * * 0.1553 3.166   # oxygen-oxygen
</pre></div>
</div>
<p><strong>Non-equilibrium MD</strong></p>
<p>Shear flow (NEMD):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fix 1 all nvt/sllod temp 1.0 1.0 0.1
fix 2 all deform 1 xy erate 0.01 remap v  # shear strain rate
</pre></div>
</div>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>LAMMPS Documentation</strong>
Plimpton, S. (1995). <em>Fast Parallel Algorithms for Short-Range Molecular Dynamics</em>. Journal of Computational Physics, 117(1), 1-19.
<a class="reference external" href="https://docs.lammps.org">https://docs.lammps.org</a></p></li>
<li><p><strong>Molecular Dynamics Theory</strong>
Frenkel, D., &amp; Smit, B. (2001). <em>Understanding Molecular Simulation: From Algorithms to Applications</em> (2nd ed.). Academic Press.</p></li>
<li><p><strong>Statistical Mechanics</strong>
Allen, M. P., &amp; Tildesley, D. J. (2017). <em>Computer Simulation of Liquids</em> (2nd ed.). Oxford University Press.</p></li>
<li><p><strong>Lennard-Jones Fluid</strong>
Verlet, L. (1967). <em>Computer “Experiments” on Classical Fluids. I. Thermodynamical Properties of Lennard-Jones Molecules</em>. Physical Review, 159(1), 98-103.</p></li>
<li><p><strong>Integration Algorithms</strong>
Swope, W. C., Andersen, H. C., Berens, P. H., &amp; Wilson, K. R. (1982). <em>A Computer Simulation Method for the Calculation of Equilibrium Constants</em>. The Journal of Chemical Physics, 76(1), 637-649.</p></li>
<li><p><strong>Nosé-Hoover Thermostat</strong>
Nosé, S. (1984). <em>A Molecular Dynamics Method for Simulations in the Canonical Ensemble</em>. Molecular Physics, 52(2), 255-268.
Hoover, W. G. (1985). <em>Canonical Dynamics: Equilibrium Phase-Space Distributions</em>. Physical Review A, 31(3), 1695-1697.</p></li>
<li><p><strong>Pressure Control</strong>
Parrinello, M., &amp; Rahman, A. (1981). <em>Polymorphic Transitions in Single Crystals: A New Molecular Dynamics Method</em>. Journal of Applied Physics, 52(12), 7182-7190.</p></li>
<li><p><strong>Energy Minimization</strong>
Press, W. H., Teukolsky, S. A., Vetterling, W. T., &amp; Flannery, B. P. (2007). <em>Numerical Recipes: The Art of Scientific Computing</em> (3rd ed.). Cambridge University Press.</p></li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="force_fields.html" class="btn btn-neutral float-left" title="Force Fields : Water" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="harmonic_oscillator.html" class="btn btn-neutral float-right" title="Quantum Harmonic Oscillator" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright J. V. V. Cassiano.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>